2024-07-11 01:44:17   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=128, lr=1.2e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume='logs/dinov2_vitb14_netvlad/gsv_cities/k64_GPMS/best_model.pth', save_dir='logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-11_01-44-17', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=True, use_extra_datasets=True, use_linear=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-11 01:44:17   The outputs are being saved in logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-11_01-44-17
2024-07-11 01:44:17   Using 2 GPUs
2024-07-11 01:44:17   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-11 01:44:17   using MLP layer as FFN
2024-07-11 01:44:19   Linear as Learned PCA
2024-07-11 01:44:19   trainable params: 295296 || all params: 86974080 || trainable%: 0.34
2024-07-11 01:44:19   module.aggregation.feat_proj.weight, module.aggregation.cls_proj.weight
2024-07-11 01:44:19   Resuming from epoch 1 with best recall@1 94.6
2024-07-11 01:44:19   Start training epoch: 01
2024-07-11 01:53:54   Finished epoch 01 in 0:09:25, average epoch loss = 0.4602
2024-07-11 01:56:36   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.68, R@5: 95.68, R@10: 96.35, R@100: 98.51
2024-07-11 01:56:36   Improved: previous best R@1 = 0.0, current R@1 = 90.7
2024-07-11 01:56:36   Start training epoch: 02
2024-07-11 02:13:05   Finished epoch 02 in 0:16:19, average epoch loss = 0.3903
2024-07-11 02:14:48   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.35, R@5: 95.68, R@10: 96.49, R@100: 98.51
2024-07-11 02:14:48   Improved: previous best R@1 = 90.7, current R@1 = 91.4
2024-07-11 02:14:48   Start training epoch: 03
2024-07-11 02:24:22   Finished epoch 03 in 0:09:25, average epoch loss = 0.3764
2024-07-11 02:26:05   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.49, R@5: 95.68, R@10: 96.62, R@100: 98.65
2024-07-11 02:26:05   Improved: previous best R@1 = 91.4, current R@1 = 91.5
2024-07-11 02:26:05   Start training epoch: 04
2024-07-11 02:35:39   Finished epoch 04 in 0:09:24, average epoch loss = 0.3721
2024-07-11 02:37:21   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.49, R@5: 95.81, R@10: 96.89, R@100: 98.65
2024-07-11 02:37:21   Not improved: 1 / 10: best R@1 = 91.5, current R@1 = 91.5
2024-07-11 02:37:22   Best R@1: 91.5
2024-07-11 02:37:22   Trained for 05 epochs, in total in 0:53:04
2024-07-11 02:37:22   using MLP layer as FFN
2024-07-11 02:37:23   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-11 02:40:01   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 91.68, R@5: 96.24, R@10: 97.45, R@100: 99.16
2024-07-11 02:40:01   Finished in 0:55:43
2024-07-11 02:40:01   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-11 02:42:12   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 90.97, R@5: 95.82, R@10: 96.87, R@100: 99.29
2024-07-11 02:42:12   Finished in 0:57:54
