2024-07-07 04:57:58   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-07_04-57-58', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 04:57:58   The outputs are being saved in logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-07_04-57-58
2024-07-07 04:57:58   Using 2 GPUs
2024-07-07 04:57:58   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-07 04:57:58   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 04:57:58   using MLP layer as FFN
2024-07-07 04:58:00   Extracting features to initialize NetVLAD layer
2024-07-07 04:58:10   NetVLAD centroids shape: (64, 768)
2024-07-07 04:58:10   trainable params: 28455936 || all params: 86678784 || trainable%: 32.83
2024-07-07 04:58:10   Start training epoch: 00
2024-07-07 05:14:45   Finished epoch 00 in 0:16:26, average epoch loss = 0.4129
2024-07-07 05:14:45   Extracting database features for evaluation/testing
2024-07-07 05:16:20   Extracting queries features for evaluation/testing
2024-07-07 05:16:28   Calculating recalls
2024-07-07 05:16:59   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.65, R@5: 96.89, R@10: 97.57, R@100: 99.05
2024-07-07 05:16:59   Improved: previous best R@1 = 0.0, current R@1 = 93.6
2024-07-07 05:17:00   Start training epoch: 01
2024-07-07 05:33:33   Finished epoch 01 in 0:16:24, average epoch loss = 0.3101
2024-07-07 05:33:33   Extracting database features for evaluation/testing
2024-07-07 05:35:08   Extracting queries features for evaluation/testing
2024-07-07 05:35:16   Calculating recalls
2024-07-07 05:35:47   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.59, R@5: 97.57, R@10: 97.97, R@100: 98.92
2024-07-07 05:35:47   Improved: previous best R@1 = 93.6, current R@1 = 94.6
2024-07-07 05:35:48   Start training epoch: 02
2024-07-07 05:52:21   Finished epoch 02 in 0:16:25, average epoch loss = 0.2669
2024-07-07 05:52:21   Extracting database features for evaluation/testing
2024-07-07 05:53:57   Extracting queries features for evaluation/testing
2024-07-07 05:54:05   Calculating recalls
2024-07-07 05:54:36   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.78, R@5: 97.30, R@10: 97.84, R@100: 99.05
2024-07-07 05:54:36   Not improved: 1 / 10: best R@1 = 94.6, current R@1 = 93.8
2024-07-07 05:54:36   Start training epoch: 03
2024-07-07 06:11:09   Finished epoch 03 in 0:16:24, average epoch loss = 0.2358
2024-07-07 06:11:09   Extracting database features for evaluation/testing
2024-07-07 06:12:45   Extracting queries features for evaluation/testing
2024-07-07 06:12:53   Calculating recalls
2024-07-07 06:13:24   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.51, R@5: 97.30, R@10: 98.24, R@100: 99.05
2024-07-07 06:13:24   Not improved: 2 / 10: best R@1 = 94.6, current R@1 = 93.5
2024-07-07 06:13:24   Start training epoch: 04
2024-07-07 06:29:57   Finished epoch 04 in 0:16:25, average epoch loss = 0.2097
2024-07-07 06:29:57   Extracting database features for evaluation/testing
2024-07-07 06:31:33   Extracting queries features for evaluation/testing
2024-07-07 06:31:41   Calculating recalls
2024-07-07 06:32:12   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.46, R@5: 97.43, R@10: 97.97, R@100: 99.19
2024-07-07 06:32:12   Not improved: 3 / 10: best R@1 = 94.6, current R@1 = 94.5
2024-07-07 06:32:12   Best R@1: 94.6
2024-07-07 06:32:12   Trained for 05 epochs, in total in 1:34:14
2024-07-07 06:32:12   using MLP layer as FFN
2024-07-07 06:32:14   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 06:32:14   Extracting database features for evaluation/testing
2024-07-07 06:33:35   Extracting queries features for evaluation/testing
2024-07-07 06:34:32   Calculating recalls
2024-07-07 06:37:00   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 93.49, R@5: 97.37, R@10: 98.02, R@100: 99.35
2024-07-07 06:37:00   Finished in 1:39:01
2024-07-07 06:37:00   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 06:37:00   Extracting database features for evaluation/testing
2024-07-07 06:37:54   Extracting queries features for evaluation/testing
2024-07-07 06:38:50   Calculating recalls
2024-07-07 06:41:09   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 96.27, R@5: 98.22, R@10: 98.66, R@100: 99.65
2024-07-07 06:41:09   Finished in 1:43:11
