2024-07-06 22:35:37   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-06_22-35-37', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-06 22:35:37   The outputs are being saved in logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-06_22-35-37
2024-07-06 22:35:37   Using 2 GPUs
2024-07-06 22:35:38   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-06 22:35:38   using MLP layer as FFN
2024-07-06 22:35:49   trainable params: 28455936 || all params: 86678784 || trainable%: 32.83
2024-07-06 22:35:49   Start training epoch: 00
2024-07-06 22:41:04   Finished epoch 00 in 0:05:14, average epoch loss = 0.4412
2024-07-06 22:43:17   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.0, R@5: 96.2, R@10: 96.8, R@100: 98.4
2024-07-06 22:43:17   Improved: previous best R@1 = 0.0, current R@1 = 92.0
2024-07-06 22:43:18   Start training epoch: 01
2024-07-06 22:48:30   Finished epoch 01 in 0:05:12, average epoch loss = 0.3040
2024-07-06 22:50:43   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.4, R@5: 96.1, R@10: 96.6, R@100: 98.5
2024-07-06 22:50:43   Improved: previous best R@1 = 92.0, current R@1 = 92.4
2024-07-06 22:50:44   Start training epoch: 02
2024-07-06 22:55:56   Finished epoch 02 in 0:05:12, average epoch loss = 0.2515
2024-07-06 22:58:10   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.0, R@5: 96.5, R@10: 96.9, R@100: 98.6
2024-07-06 22:58:10   Improved: previous best R@1 = 92.4, current R@1 = 93.0
2024-07-06 22:58:11   Start training epoch: 03
2024-07-06 23:03:23   Finished epoch 03 in 0:05:11, average epoch loss = 0.2165
2024-07-06 23:05:36   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.7, R@5: 96.2, R@10: 96.6, R@100: 98.6
2024-07-06 23:05:36   Not improved: 1 / 10: best R@1 = 93.0, current R@1 = 92.7
2024-07-06 23:05:36   Start training epoch: 04
2024-07-06 23:10:48   Finished epoch 04 in 0:05:11, average epoch loss = 0.1928
2024-07-06 23:13:01   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.6, R@5: 96.2, R@10: 96.9, R@100: 98.8
2024-07-06 23:13:01   Not improved: 2 / 10: best R@1 = 93.0, current R@1 = 92.6
2024-07-06 23:13:02   Best R@1: 93.0
2024-07-06 23:13:02   Trained for 05 epochs, in total in 0:37:25
2024-07-06 23:13:02   using MLP layer as FFN
2024-07-06 23:13:04   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-06 23:17:48   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 93.0, R@5: 96.7, R@10: 98.0, R@100: 99.5
2024-07-06 23:17:48   Finished in 0:42:11
