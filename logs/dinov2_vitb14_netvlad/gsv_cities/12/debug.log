2024-07-21 19:55:15   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=12, lr=1.2e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[322, 322], resize_test_imgs=True, resume='logs/dinov2_vitb14_netvlad/gsv_cities/k64_GPMS_322/best_model.pth', save_dir='logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-21_19-55-15', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_linear=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-21 19:55:15   The outputs are being saved in logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-21_19-55-15
2024-07-21 19:55:15   Using 2 GPUs
2024-07-21 19:55:15   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-21 19:55:15   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-21 19:55:15   using MLP layer as FFN
2024-07-21 19:55:17   Linear as Learned PCA and only fine-tuning linear.
2024-07-21 19:55:17   trainable params: 9228 || all params: 86688012 || trainable%: 0.01
2024-07-21 19:55:17   module.aggregation.feat_proj.weight
2024-07-21 19:55:17   Loading checkpoint: logs/dinov2_vitb14_netvlad/gsv_cities/k64_GPMS_322/best_model.pth
2024-07-21 19:55:17   Loaded checkpoint: start_epoch_num = 1, current_best_R@1 = 94.5
2024-07-21 19:55:17   Resuming from epoch 1 with best recall@1 94.5
2024-07-21 19:55:17   Start training epoch: 01
2024-07-21 20:11:14   Finished epoch 01 in 0:15:46, average epoch loss = 0.7033
2024-07-21 20:11:14   Extracting database features for evaluation/testing
2024-07-21 20:12:47   Extracting queries features for evaluation/testing
2024-07-21 20:12:53   Calculating recalls
2024-07-21 20:12:53   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 87.57, R@5: 94.32, R@10: 95.41, R@100: 97.30
2024-07-21 20:12:53   Improved: previous best R@1 = 0.0, current R@1 = 87.6
2024-07-21 20:12:54   Start training epoch: 02
2024-07-21 20:28:43   Finished epoch 02 in 0:15:41, average epoch loss = 0.5485
2024-07-21 20:28:43   Extracting database features for evaluation/testing
2024-07-21 20:30:16   Extracting queries features for evaluation/testing
2024-07-21 20:30:22   Calculating recalls
2024-07-21 20:30:22   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.46, R@5: 94.59, R@10: 95.54, R@100: 97.70
2024-07-21 20:30:22   Improved: previous best R@1 = 87.6, current R@1 = 89.5
2024-07-21 20:30:23   Start training epoch: 03
2024-07-21 20:46:13   Finished epoch 03 in 0:15:41, average epoch loss = 0.5188
2024-07-21 20:46:13   Extracting database features for evaluation/testing
2024-07-21 20:47:46   Extracting queries features for evaluation/testing
2024-07-21 20:47:52   Calculating recalls
2024-07-21 20:47:52   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.73, R@5: 94.46, R@10: 95.81, R@100: 98.11
2024-07-21 20:47:52   Improved: previous best R@1 = 89.5, current R@1 = 89.7
2024-07-21 20:47:53   Start training epoch: 04
2024-07-21 21:03:44   Finished epoch 04 in 0:15:41, average epoch loss = 0.5017
2024-07-21 21:03:44   Extracting database features for evaluation/testing
2024-07-21 21:05:16   Extracting queries features for evaluation/testing
2024-07-21 21:05:22   Calculating recalls
2024-07-21 21:05:23   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.00, R@5: 94.86, R@10: 96.08, R@100: 98.24
2024-07-21 21:05:23   Improved: previous best R@1 = 89.7, current R@1 = 90.0
2024-07-21 21:05:23   Best R@1: 90.0
2024-07-21 21:05:23   Trained for 05 epochs, in total in 1:10:07
2024-07-21 21:05:23   using MLP layer as FFN
2024-07-21 21:05:25   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-21 21:05:25   Extracting database features for evaluation/testing
2024-07-21 21:06:44   Extracting queries features for evaluation/testing
2024-07-21 21:07:39   Calculating recalls
2024-07-21 21:07:42   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 90.82, R@5: 95.94, R@10: 97.02, R@100: 99.03
2024-07-21 21:07:42   Finished in 1:12:26
2024-07-21 21:07:42   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-21 21:07:42   Extracting database features for evaluation/testing
2024-07-21 21:08:36   Extracting queries features for evaluation/testing
2024-07-21 21:09:30   Calculating recalls
2024-07-21 21:09:32   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 88.31, R@5: 93.91, R@10: 95.46, R@100: 98.50
2024-07-21 21:09:32   Finished in 1:14:17
