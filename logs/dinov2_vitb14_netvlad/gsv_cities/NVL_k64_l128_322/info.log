2024-07-12 18:56:02   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=128, lr=1.2e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder='pitts30k/images/train', pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[322, 322], resize_test_imgs=True, resume='logs/dinov2_vitb14_netvlad/gsv_cities/k64_GPMS_322/best_model.pth', save_dir='logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-12_18-56-02', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_linear=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-12 18:56:02   The outputs are being saved in logs/dinov2_vitb14_netvlad/gsv_cities/2024-07-12_18-56-02
2024-07-12 18:56:02   Using 4 GPUs
2024-07-12 18:56:03   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-12 18:56:03   using MLP layer as FFN
2024-07-12 18:56:05   Linear as Learned PCA and only fine-tuning linear.
2024-07-12 18:56:05   trainable params: 98432 || all params: 86777216 || trainable%: 0.11
2024-07-12 18:56:05   module.aggregation.feat_proj.weight
2024-07-12 18:56:06   Resuming from epoch 1 with best recall@1 94.5
2024-07-12 18:56:06   Start training epoch: 01
2024-07-12 19:08:26   Finished epoch 01 in 0:12:07, average epoch loss = 0.3660
2024-07-12 19:10:07   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.19, R@5: 97.30, R@10: 97.70, R@100: 98.65
2024-07-12 19:10:07   Improved: previous best R@1 = 0.0, current R@1 = 94.2
2024-07-12 19:10:07   Start training epoch: 02
2024-07-12 19:22:28   Finished epoch 02 in 0:12:10, average epoch loss = 0.2749
2024-07-12 19:23:44   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.32, R@5: 97.16, R@10: 97.70, R@100: 98.65
2024-07-12 19:23:44   Improved: previous best R@1 = 94.2, current R@1 = 94.3
2024-07-12 19:23:45   Start training epoch: 03
2024-07-12 19:36:08   Finished epoch 03 in 0:12:13, average epoch loss = 0.2667
2024-07-12 19:37:31   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.92, R@5: 97.03, R@10: 97.70, R@100: 98.65
2024-07-12 19:37:31   Not improved: 1 / 10: best R@1 = 94.3, current R@1 = 93.9
2024-07-12 19:37:32   Start training epoch: 04
2024-07-12 19:49:41   Finished epoch 04 in 0:11:58, average epoch loss = 0.2646
2024-07-12 19:51:01   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.65, R@5: 97.03, R@10: 97.70, R@100: 98.65
2024-07-12 19:51:01   Not improved: 2 / 10: best R@1 = 94.3, current R@1 = 93.6
2024-07-12 19:51:02   Best R@1: 94.3
2024-07-12 19:51:02   Trained for 05 epochs, in total in 0:54:59
2024-07-12 19:51:02   using MLP layer as FFN
2024-07-12 19:51:04   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-12 19:53:17   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 93.66, R@5: 97.39, R@10: 98.15, R@100: 99.41
2024-07-12 19:53:17   Finished in 0:57:14
2024-07-12 19:53:17   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-12 19:55:13   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 95.70, R@5: 98.17, R@10: 98.66, R@100: 99.52
2024-07-12 19:55:13   Finished in 0:59:10
