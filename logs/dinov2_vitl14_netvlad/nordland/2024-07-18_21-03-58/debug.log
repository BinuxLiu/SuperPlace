2024-07-18 21:03:58   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitl14', ca_method='gem', clusters=64, dataset_name='nordland', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=4, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=False, resume='logs/dinov2_vitl14_netvlad/gsv_cities/k64_GPMS/best_model.pth', save_dir='logs/dinov2_vitl14_netvlad/nordland/2024-07-18_21-03-58', save_only_wrong_preds=False, seed=0, train_batch_size=32, trainable_layers='8, 9, 10, 11', use_amp16=False, use_ca=False, use_cls=False, use_extra_datasets=False, use_linear=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-18 21:03:58   The outputs are being saved in logs/dinov2_vitl14_netvlad/nordland/2024-07-18_21-03-58
2024-07-18 21:03:58   using MLP layer as FFN
2024-07-18 21:04:03   Resuming model from logs/dinov2_vitl14_netvlad/gsv_cities/k64_GPMS/best_model.pth
2024-07-18 21:04:04   Test set: < BaseDataset, nordland - #database: 27592; #queries: 27592 >
2024-07-18 21:04:04   Extracting database features for evaluation/testing
2024-07-18 21:08:57   Extracting queries features for evaluation/testing
2024-07-18 21:10:16   
Traceback (most recent call last):
  File "eval.py", line 70, in <module>
    recalls, recalls_str = test_embodied.test(args, test_ds, model)
  File "/root/autodl-tmp/DomainPlaces/utils/test_embodied.py", line 110, in test
    features = model(inputs.to("cuda"))
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 185, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 200, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 102, in parallel_apply
    _worker(0, modules[0], inputs[0], kwargs_tup[0], devices[0], streams[0])
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 83, in _worker
    output = module(*input, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/autodl-tmp/DomainPlaces/models/vgl_network.py", line 44, in forward
    x = self.backbone(x)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/autodl-tmp/DomainPlaces/models/dinov2_network.py", line 80, in forward
    x = blk(x)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/autodl-tmp/DomainPlaces/models/dino_layers/block.py", line 254, in forward
    return super().forward(x_or_x_list)
  File "/root/autodl-tmp/DomainPlaces/models/dino_layers/block.py", line 112, in forward
    x = x + attn_residual_func(x)
  File "/root/autodl-tmp/DomainPlaces/models/dino_layers/block.py", line 91, in attn_residual_func
    return self.ls1(self.attn(self.norm1(x)))
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/autodl-tmp/DomainPlaces/models/dino_layers/attention.py", line 97, in forward
    x = self.proj(x)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/binux/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt

