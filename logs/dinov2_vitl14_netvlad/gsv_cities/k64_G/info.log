2024-07-04 20:56:33   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitl14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=10, features_dim=768, infer_batch_size=256, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=32, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitl14_netvlad/gsv_cities/2024-07-04_20-56-33', save_only_wrong_preds=False, seed=0, train_batch_size=128, trainable_layers='19,20,21,22,23', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-04 20:56:33   The outputs are being saved in logs/dinov2_vitl14_netvlad/gsv_cities/2024-07-04_20-56-33
2024-07-04 20:56:33   Using 4 GPUs
2024-07-04 20:56:34   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-04 20:56:34   using MLP layer as FFN
2024-07-04 20:57:03   trainable params: 63122432 || all params: 304499712 || trainable%: 20.73
2024-07-04 20:57:03   Start training epoch: 00
2024-07-04 21:03:17   Finished epoch 00 in 0:06:14, average epoch loss = 0.4813
2024-07-04 21:06:47   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.4, R@5: 96.2, R@10: 97.0, R@100: 98.8
2024-07-04 21:06:47   Improved: previous best R@1 = 0.0, current R@1 = 91.4
2024-07-04 21:06:48   Start training epoch: 01
2024-07-04 21:12:59   Finished epoch 01 in 0:06:10, average epoch loss = 0.3152
2024-07-04 21:16:21   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.4, R@5: 96.5, R@10: 97.0, R@100: 98.8
2024-07-04 21:16:21   Improved: previous best R@1 = 91.4, current R@1 = 93.4
2024-07-04 21:16:23   Start training epoch: 02
2024-07-04 21:22:33   Finished epoch 02 in 0:06:10, average epoch loss = 0.2576
2024-07-04 21:25:52   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.0, R@5: 96.9, R@10: 97.0, R@100: 98.8
2024-07-04 21:25:52   Not improved: 1 / 10: best R@1 = 93.4, current R@1 = 93.0
2024-07-04 21:25:54   Start training epoch: 03
2024-07-04 21:32:04   Finished epoch 03 in 0:06:10, average epoch loss = 0.2215
2024-07-04 21:35:21   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.8, R@5: 97.0, R@10: 97.4, R@100: 98.8
2024-07-04 21:35:21   Improved: previous best R@1 = 93.4, current R@1 = 93.8
2024-07-04 21:35:23   Start training epoch: 04
2024-07-04 21:41:34   Finished epoch 04 in 0:06:10, average epoch loss = 0.1941
2024-07-04 21:44:51   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.4, R@5: 96.9, R@10: 97.3, R@100: 98.9
2024-07-04 21:44:51   Not improved: 1 / 10: best R@1 = 93.8, current R@1 = 93.4
2024-07-04 21:44:52   Start training epoch: 05
2024-07-04 21:51:03   Finished epoch 05 in 0:06:10, average epoch loss = 0.1757
2024-07-04 21:54:20   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.0, R@5: 97.0, R@10: 97.2, R@100: 98.6
2024-07-04 21:54:20   Not improved: 2 / 10: best R@1 = 93.8, current R@1 = 93.0
2024-07-04 21:54:21   Start training epoch: 06
2024-07-04 22:00:31   Finished epoch 06 in 0:06:09, average epoch loss = 0.1541
2024-07-04 22:03:48   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.8, R@5: 96.8, R@10: 97.2, R@100: 98.8
2024-07-04 22:03:48   Not improved: 3 / 10: best R@1 = 93.8, current R@1 = 92.8
2024-07-04 22:03:49   Start training epoch: 07
2024-07-04 22:10:00   Finished epoch 07 in 0:06:10, average epoch loss = 0.1400
2024-07-04 22:13:19   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.1, R@5: 96.8, R@10: 97.0, R@100: 98.9
2024-07-04 22:13:19   Not improved: 4 / 10: best R@1 = 93.8, current R@1 = 93.1
2024-07-04 22:13:20   Start training epoch: 08
2024-07-04 22:19:32   Finished epoch 08 in 0:06:11, average epoch loss = 0.1296
2024-07-04 22:22:49   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.4, R@5: 96.8, R@10: 96.9, R@100: 98.8
2024-07-04 22:22:49   Not improved: 5 / 10: best R@1 = 93.8, current R@1 = 93.4
2024-07-04 22:22:50   Start training epoch: 09
2024-07-04 22:29:01   Finished epoch 09 in 0:06:10, average epoch loss = 0.1222
2024-07-04 22:32:19   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.5, R@5: 96.8, R@10: 97.0, R@100: 98.8
2024-07-04 22:32:19   Not improved: 6 / 10: best R@1 = 93.8, current R@1 = 93.5
2024-07-04 22:32:20   Best R@1: 93.8
2024-07-04 22:32:20   Trained for 10 epochs, in total in 1:35:47
2024-07-04 22:32:20   using MLP layer as FFN
2024-07-04 22:32:25   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-04 22:39:18   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 93.4, R@5: 97.0, R@10: 97.9, R@100: 99.4
2024-07-04 22:39:18   Finished in 1:42:44
