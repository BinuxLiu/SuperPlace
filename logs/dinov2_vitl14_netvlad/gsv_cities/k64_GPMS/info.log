2024-07-08 03:59:35   Arguments: Namespace(aggregation='netvlad', backbone='dinov2_vitl14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=6, features_dim=768, infer_batch_size=64, linear_dim=256, lr=2e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[322, 322], resize_test_imgs=True, resume='logs/dinov2_vitl14_netvlad/gsv_cities/2024-07-08_01-13-45/best_model.pth', save_dir='logs/dinov2_vitl14_netvlad/gsv_cities/2024-07-08_03-59-35', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='19,20,21,22,23', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-08 03:59:35   The outputs are being saved in logs/dinov2_vitl14_netvlad/gsv_cities/2024-07-08_03-59-35
2024-07-08 03:59:35   Using 4 GPUs
2024-07-08 03:59:35   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-08 03:59:35   using MLP layer as FFN
2024-07-08 03:59:41   trainable params: 63122432 || all params: 304499712 || trainable%: 20.73
2024-07-08 03:59:42   Resuming from epoch 3 with best recall@1 94.5
2024-07-08 03:59:42   Start training epoch: 03
2024-07-08 04:38:24   Finished epoch 03 in 0:38:33, average epoch loss = 0.1249
2024-07-08 04:41:51   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.19, R@5: 97.70, R@10: 97.97, R@100: 99.05
2024-07-08 04:41:51   Not improved: 1 / 10: best R@1 = 94.5, current R@1 = 94.2
2024-07-08 04:41:52   Start training epoch: 04
2024-07-08 05:20:28   Finished epoch 04 in 0:38:27, average epoch loss = 0.1130
2024-07-08 05:23:57   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.86, R@5: 97.84, R@10: 98.38, R@100: 99.05
2024-07-08 05:23:57   Improved: previous best R@1 = 94.5, current R@1 = 94.9
2024-07-08 05:23:59   Start training epoch: 05
2024-07-08 06:02:34   Finished epoch 05 in 0:38:27, average epoch loss = 0.1036
2024-07-08 06:06:02   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 95.41, R@5: 97.84, R@10: 98.11, R@100: 98.92
2024-07-08 06:06:02   Improved: previous best R@1 = 94.9, current R@1 = 95.4
2024-07-08 06:06:04   Best R@1: 95.4
2024-07-08 06:06:04   Trained for 06 epochs, in total in 2:06:29
2024-07-08 06:06:04   using MLP layer as FFN
2024-07-08 06:06:09   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-08 06:12:57   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 94.45, R@5: 97.84, R@10: 98.55, R@100: 99.68
2024-07-08 06:12:57   Finished in 2:13:22
2024-07-08 06:12:57   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-08 06:18:55   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 97.60, R@5: 99.05, R@10: 99.31, R@100: 99.85
2024-07-08 06:18:55   Finished in 2:19:19
