2024-07-07 12:23:30   Arguments: Namespace(aggregation='salad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=544, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_12-23-30', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 12:23:30   The outputs are being saved in logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_12-23-30
2024-07-07 12:23:30   Using 1 GPUs
2024-07-07 12:23:30   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 12:23:30   using MLP layer as FFN
2024-07-07 12:23:32   trainable params: 29579857 || all params: 87802705 || trainable%: 33.69
2024-07-07 12:23:32   Start training epoch: 00
2024-07-07 12:38:17   Finished epoch 00 in 0:14:35, average epoch loss = 0.5088
2024-07-07 12:40:46   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.32, R@5: 94.59, R@10: 96.08, R@100: 98.11
2024-07-07 12:40:46   Improved: previous best R@1 = 0.0, current R@1 = 89.3
2024-07-07 12:40:47   Start training epoch: 01
2024-07-07 12:55:27   Finished epoch 01 in 0:14:31, average epoch loss = 0.3780
2024-07-07 12:57:57   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.41, R@5: 96.35, R@10: 97.16, R@100: 98.92
2024-07-07 12:57:57   Improved: previous best R@1 = 89.3, current R@1 = 90.4
2024-07-07 12:57:58   Start training epoch: 02
2024-07-07 13:12:37   Finished epoch 02 in 0:14:31, average epoch loss = 0.3226
2024-07-07 13:15:10   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.62, R@5: 96.62, R@10: 97.16, R@100: 98.92
2024-07-07 13:15:10   Improved: previous best R@1 = 90.4, current R@1 = 91.6
2024-07-07 13:15:11   Start training epoch: 03
2024-07-07 13:29:54   Finished epoch 03 in 0:14:34, average epoch loss = 0.2824
2024-07-07 13:32:24   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.95, R@5: 96.62, R@10: 97.03, R@100: 98.65
2024-07-07 13:32:24   Not improved: 1 / 10: best R@1 = 91.6, current R@1 = 90.9
2024-07-07 13:32:24   Start training epoch: 04
2024-07-07 13:47:04   Finished epoch 04 in 0:14:31, average epoch loss = 0.2500
2024-07-07 13:49:33   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.30, R@5: 96.76, R@10: 97.57, R@100: 98.92
2024-07-07 13:49:33   Improved: previous best R@1 = 91.6, current R@1 = 92.3
2024-07-07 13:49:34   Best R@1: 92.3
2024-07-07 13:49:34   Trained for 05 epochs, in total in 1:26:03
2024-07-07 13:49:34   using MLP layer as FFN
2024-07-07 13:49:35   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 13:53:16   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 91.31, R@5: 96.55, R@10: 97.43, R@100: 99.11
2024-07-07 13:53:16   Finished in 1:29:45
2024-07-07 13:53:16   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 13:56:10   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 92.91, R@5: 97.12, R@10: 98.15, R@100: 99.44
2024-07-07 13:56:10   Finished in 1:32:40
