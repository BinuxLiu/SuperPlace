2024-07-07 12:23:40   Arguments: Namespace(aggregation='salad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=544, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_12-23-40', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 12:23:40   The outputs are being saved in logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_12-23-40
2024-07-07 12:23:40   Using 1 GPUs
2024-07-07 12:23:40   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-07 12:23:41   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 12:23:41   using MLP layer as FFN
2024-07-07 12:23:42   trainable params: 29579857 || all params: 87802705 || trainable%: 33.69
2024-07-07 12:23:42   Start training epoch: 00
2024-07-07 12:28:25   Finished epoch 00 in 0:04:42, average epoch loss = 0.5370
2024-07-07 12:28:25   Extracting database features for evaluation/testing
2024-07-07 12:30:49   Extracting queries features for evaluation/testing
2024-07-07 12:30:56   Calculating recalls
2024-07-07 12:30:56   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 87.30, R@5: 94.86, R@10: 95.95, R@100: 98.38
2024-07-07 12:30:56   Improved: previous best R@1 = 0.0, current R@1 = 87.3
2024-07-07 12:30:57   Start training epoch: 01
2024-07-07 12:35:35   Finished epoch 01 in 0:04:38, average epoch loss = 0.3825
2024-07-07 12:35:35   Extracting database features for evaluation/testing
2024-07-07 12:37:59   Extracting queries features for evaluation/testing
2024-07-07 12:38:06   Calculating recalls
2024-07-07 12:38:06   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.11, R@5: 95.54, R@10: 96.49, R@100: 98.38
2024-07-07 12:38:06   Improved: previous best R@1 = 87.3, current R@1 = 88.1
2024-07-07 12:38:07   Start training epoch: 02
2024-07-07 12:42:45   Finished epoch 02 in 0:04:38, average epoch loss = 0.3197
2024-07-07 12:42:45   Extracting database features for evaluation/testing
2024-07-07 12:45:09   Extracting queries features for evaluation/testing
2024-07-07 12:45:16   Calculating recalls
2024-07-07 12:45:16   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.59, R@5: 95.14, R@10: 96.22, R@100: 98.65
2024-07-07 12:45:16   Improved: previous best R@1 = 88.1, current R@1 = 89.6
2024-07-07 12:45:17   Start training epoch: 03
2024-07-07 12:49:55   Finished epoch 03 in 0:04:38, average epoch loss = 0.2764
2024-07-07 12:49:55   Extracting database features for evaluation/testing
2024-07-07 12:52:18   Extracting queries features for evaluation/testing
2024-07-07 12:52:26   Calculating recalls
2024-07-07 12:52:26   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.73, R@5: 95.41, R@10: 96.22, R@100: 98.24
2024-07-07 12:52:26   Improved: previous best R@1 = 89.6, current R@1 = 89.7
2024-07-07 12:52:27   Start training epoch: 04
2024-07-07 12:57:06   Finished epoch 04 in 0:04:38, average epoch loss = 0.2465
2024-07-07 12:57:06   Extracting database features for evaluation/testing
2024-07-07 12:59:29   Extracting queries features for evaluation/testing
2024-07-07 12:59:36   Calculating recalls
2024-07-07 12:59:36   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.81, R@5: 95.68, R@10: 96.62, R@100: 98.24
2024-07-07 12:59:36   Improved: previous best R@1 = 89.7, current R@1 = 90.8
2024-07-07 12:59:37   Best R@1: 90.8
2024-07-07 12:59:37   Trained for 05 epochs, in total in 0:35:57
2024-07-07 12:59:37   using MLP layer as FFN
2024-07-07 12:59:39   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 12:59:39   Extracting database features for evaluation/testing
2024-07-07 13:01:49   Extracting queries features for evaluation/testing
2024-07-07 13:03:19   Calculating recalls
2024-07-07 13:03:22   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 90.45, R@5: 95.97, R@10: 97.24, R@100: 99.11
2024-07-07 13:03:22   Finished in 0:39:41
2024-07-07 13:03:22   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 13:03:22   Extracting database features for evaluation/testing
2024-07-07 13:04:49   Extracting queries features for evaluation/testing
2024-07-07 13:06:17   Calculating recalls
2024-07-07 13:06:19   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 90.27, R@5: 95.28, R@10: 96.66, R@100: 99.30
2024-07-07 13:06:19   Finished in 0:42:38
