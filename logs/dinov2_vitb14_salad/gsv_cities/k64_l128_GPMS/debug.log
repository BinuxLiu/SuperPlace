2024-07-07 10:16:18   Arguments: Namespace(aggregation='salad', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=8448, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_10-16-18', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 10:16:18   The outputs are being saved in logs/dinov2_vitb14_salad/gsv_cities/2024-07-07_10-16-18
2024-07-07 10:16:18   Using 1 GPUs
2024-07-07 10:16:18   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-07 10:16:19   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 10:16:19   using MLP layer as FFN
2024-07-07 10:16:20   trainable params: 29768641 || all params: 87991489 || trainable%: 33.83
2024-07-07 10:16:20   Start training epoch: 00
2024-07-07 10:32:22   Finished epoch 00 in 0:15:51, average epoch loss = 0.4664
2024-07-07 10:32:22   Extracting database features for evaluation/testing
2024-07-07 10:34:47   Extracting queries features for evaluation/testing
2024-07-07 10:34:55   Calculating recalls
2024-07-07 10:35:00   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.70, R@5: 96.89, R@10: 97.30, R@100: 98.51
2024-07-07 10:35:00   Improved: previous best R@1 = 0.0, current R@1 = 92.7
2024-07-07 10:35:01   Start training epoch: 01
2024-07-07 10:51:01   Finished epoch 01 in 0:15:51, average epoch loss = 0.3593
2024-07-07 10:51:01   Extracting database features for evaluation/testing
2024-07-07 10:53:26   Extracting queries features for evaluation/testing
2024-07-07 10:53:34   Calculating recalls
2024-07-07 10:53:39   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 93.24, R@5: 96.89, R@10: 97.57, R@100: 98.92
2024-07-07 10:53:39   Improved: previous best R@1 = 92.7, current R@1 = 93.2
2024-07-07 10:53:40   Start training epoch: 02
2024-07-07 11:09:39   Finished epoch 02 in 0:15:50, average epoch loss = 0.3060
2024-07-07 11:09:39   Extracting database features for evaluation/testing
2024-07-07 11:12:04   Extracting queries features for evaluation/testing
2024-07-07 11:12:12   Calculating recalls
2024-07-07 11:12:18   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.46, R@5: 97.57, R@10: 97.84, R@100: 99.19
2024-07-07 11:12:18   Improved: previous best R@1 = 93.2, current R@1 = 94.5
2024-07-07 11:12:19   Start training epoch: 03
2024-07-07 11:28:19   Finished epoch 03 in 0:15:51, average epoch loss = 0.2684
2024-07-07 11:28:19   Extracting database features for evaluation/testing
2024-07-07 11:30:44   Extracting queries features for evaluation/testing
2024-07-07 11:30:52   Calculating recalls
2024-07-07 11:30:58   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.73, R@5: 97.43, R@10: 97.70, R@100: 99.05
2024-07-07 11:30:58   Improved: previous best R@1 = 94.5, current R@1 = 94.7
2024-07-07 11:30:59   Start training epoch: 04
2024-07-07 11:46:58   Finished epoch 04 in 0:15:50, average epoch loss = 0.2348
2024-07-07 11:46:58   Extracting database features for evaluation/testing
2024-07-07 11:49:23   Extracting queries features for evaluation/testing
2024-07-07 11:49:31   Calculating recalls
2024-07-07 11:49:37   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 94.46, R@5: 97.30, R@10: 97.43, R@100: 99.19
2024-07-07 11:49:37   Not improved: 1 / 10: best R@1 = 94.7, current R@1 = 94.5
2024-07-07 11:49:37   Best R@1: 94.7
2024-07-07 11:49:37   Trained for 05 epochs, in total in 1:33:18
2024-07-07 11:49:37   using MLP layer as FFN
2024-07-07 11:49:39   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 11:49:39   Extracting database features for evaluation/testing
2024-07-07 11:51:51   Extracting queries features for evaluation/testing
2024-07-07 11:53:22   Calculating recalls
2024-07-07 11:53:48   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.81, R@5: 96.93, R@10: 97.78, R@100: 99.13
2024-07-07 11:53:48   Finished in 1:37:29
2024-07-07 11:53:48   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 11:53:48   Extracting database features for evaluation/testing
2024-07-07 11:55:17   Extracting queries features for evaluation/testing
2024-07-07 11:56:46   Calculating recalls
2024-07-07 11:57:10   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 94.78, R@5: 98.25, R@10: 98.75, R@100: 99.67
2024-07-07 11:57:10   Finished in 1:40:51
