2024-07-06 21:45:15   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=64, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_21-45-15', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-06 21:45:15   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_21-45-15
2024-07-06 21:45:15   Using 1 GPUs
2024-07-06 21:45:15   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-06 21:45:16   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-06 21:45:16   using MLP layer as FFN
2024-07-06 21:45:17   trainable params: 29047362 || all params: 87270210 || trainable%: 33.28
2024-07-06 21:45:17   Start training epoch: 00
2024-07-06 21:50:02   Finished epoch 00 in 0:04:45, average epoch loss = 0.4360
2024-07-06 21:50:02   Extracting database features for evaluation/testing
2024-07-06 21:52:26   Extracting queries features for evaluation/testing
2024-07-06 21:52:34   Calculating recalls
2024-07-06 21:52:34   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.2, R@5: 95.3, R@10: 96.1, R@100: 98.1
2024-07-06 21:52:34   Improved: previous best R@1 = 0.0, current R@1 = 88.2
2024-07-06 21:52:35   Start training epoch: 01
2024-07-06 21:57:18   Finished epoch 01 in 0:04:43, average epoch loss = 0.2997
2024-07-06 21:57:18   Extracting database features for evaluation/testing
2024-07-06 21:59:43   Extracting queries features for evaluation/testing
2024-07-06 21:59:50   Calculating recalls
2024-07-06 21:59:50   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.2, R@5: 95.1, R@10: 96.6, R@100: 98.4
2024-07-06 21:59:50   Improved: previous best R@1 = 88.2, current R@1 = 89.2
2024-07-06 21:59:51   Start training epoch: 02
2024-07-06 22:04:36   Finished epoch 02 in 0:04:44, average epoch loss = 0.2402
2024-07-06 22:04:36   Extracting database features for evaluation/testing
2024-07-06 22:06:59   Extracting queries features for evaluation/testing
2024-07-06 22:07:06   Calculating recalls
2024-07-06 22:07:06   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.7, R@5: 95.8, R@10: 96.1, R@100: 98.2
2024-07-06 22:07:06   Improved: previous best R@1 = 89.2, current R@1 = 89.7
2024-07-06 22:07:07   Start training epoch: 03
2024-07-06 22:11:49   Finished epoch 03 in 0:04:42, average epoch loss = 0.1994
2024-07-06 22:11:49   Extracting database features for evaluation/testing
2024-07-06 22:14:11   Extracting queries features for evaluation/testing
2024-07-06 22:14:19   Calculating recalls
2024-07-06 22:14:19   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.4, R@5: 95.9, R@10: 96.4, R@100: 98.5
2024-07-06 22:14:19   Improved: previous best R@1 = 89.7, current R@1 = 90.4
2024-07-06 22:14:20   Start training epoch: 04
2024-07-06 22:19:03   Finished epoch 04 in 0:04:42, average epoch loss = 0.1692
2024-07-06 22:19:03   Extracting database features for evaluation/testing
2024-07-06 22:21:28   Extracting queries features for evaluation/testing
2024-07-06 22:21:35   Calculating recalls
2024-07-06 22:21:35   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.9, R@5: 96.1, R@10: 96.2, R@100: 98.2
2024-07-06 22:21:35   Not improved: 1 / 10: best R@1 = 90.4, current R@1 = 88.9
2024-07-06 22:21:36   Best R@1: 90.4
2024-07-06 22:21:36   Trained for 05 epochs, in total in 0:36:20
2024-07-06 22:21:36   using MLP layer as FFN
2024-07-06 22:21:38   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-06 22:21:38   Extracting database features for evaluation/testing
2024-07-06 22:23:49   Extracting queries features for evaluation/testing
2024-07-06 22:25:19   Calculating recalls
2024-07-06 22:25:22   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.6, R@5: 96.8, R@10: 97.6, R@100: 99.1
2024-07-06 22:25:22   Finished in 0:40:06
