2024-07-21 02:50:38   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=10, features_dim=8192, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=64, num_preds_to_save=0, num_workers=16, patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[322, 322], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-21_02-50-38', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=True, use_linear=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-21 02:50:38   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-21_02-50-38
2024-07-21 02:50:38   Using 2 GPUs
2024-07-21 02:50:38   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-21 02:50:38   using MLP layer as FFN
2024-07-21 02:50:40   trainable params: 34756418 || all params: 92979266 || trainable%: 37.38
2024-07-21 02:50:40   module.backbone.model.blocks.8.norm1.weight, module.backbone.model.blocks.8.attn.q.weight, module.backbone.model.blocks.8.attn.k.weight, module.backbone.model.blocks.8.attn.v.weight, module.backbone.model.blocks.8.attn.proj.weight, module.backbone.model.blocks.8.ls1.gamma, module.backbone.model.blocks.8.norm2.weight, module.backbone.model.blocks.8.mlp.fc1.weight, module.backbone.model.blocks.8.mlp.fc2.weight, module.backbone.model.blocks.8.ls2.gamma, module.backbone.model.blocks.9.norm1.weight, module.backbone.model.blocks.9.attn.q.weight, module.backbone.model.blocks.9.attn.k.weight, module.backbone.model.blocks.9.attn.v.weight, module.backbone.model.blocks.9.attn.proj.weight, module.backbone.model.blocks.9.ls1.gamma, module.backbone.model.blocks.9.norm2.weight, module.backbone.model.blocks.9.mlp.fc1.weight, module.backbone.model.blocks.9.mlp.fc2.weight, module.backbone.model.blocks.9.ls2.gamma, module.backbone.model.blocks.10.norm1.weight, module.backbone.model.blocks.10.attn.q.weight, module.backbone.model.blocks.10.attn.k.weight, module.backbone.model.blocks.10.attn.v.weight, module.backbone.model.blocks.10.attn.proj.weight, module.backbone.model.blocks.10.ls1.gamma, module.backbone.model.blocks.10.norm2.weight, module.backbone.model.blocks.10.mlp.fc1.weight, module.backbone.model.blocks.10.mlp.fc2.weight, module.backbone.model.blocks.10.ls2.gamma, module.backbone.model.blocks.11.norm1.weight, module.backbone.model.blocks.11.attn.q.weight, module.backbone.model.blocks.11.attn.k.weight, module.backbone.model.blocks.11.attn.v.weight, module.backbone.model.blocks.11.attn.proj.weight, module.backbone.model.blocks.11.ls1.gamma, module.backbone.model.blocks.11.norm2.weight, module.backbone.model.blocks.11.mlp.fc1.weight, module.backbone.model.blocks.11.mlp.fc2.weight, module.backbone.model.blocks.11.ls2.gamma, module.aggregation.gem.p, module.aggregation.channel_attention.channel_attention.0.p, module.aggregation.channel_attention.channel_attention.2.weight, module.aggregation.channel_attention.channel_attention.4.weight, module.aggregation.feat_proj.0.weight
2024-07-21 02:50:40   Start training epoch: 00
2024-07-21 03:09:24   Finished epoch 00 in 0:18:34, average epoch loss = 0.3989
2024-07-21 03:10:59   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.05, R@5: 95.68, R@10: 96.49, R@100: 98.11
2024-07-21 03:10:59   Improved: previous best R@1 = 0.0, current R@1 = 89.1
2024-07-21 03:11:00   Start training epoch: 01
2024-07-21 03:29:39   Finished epoch 01 in 0:18:30, average epoch loss = 0.2913
2024-07-21 03:31:13   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.59, R@5: 96.08, R@10: 96.76, R@100: 98.92
2024-07-21 03:31:13   Improved: previous best R@1 = 89.1, current R@1 = 89.6
2024-07-21 03:31:14   Start training epoch: 02
2024-07-21 03:49:53   Finished epoch 02 in 0:18:30, average epoch loss = 0.2386
2024-07-21 03:51:28   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.35, R@5: 95.81, R@10: 96.62, R@100: 98.38
2024-07-21 03:51:28   Improved: previous best R@1 = 89.6, current R@1 = 91.4
2024-07-21 03:51:29   Start training epoch: 03
2024-07-21 04:10:08   Finished epoch 03 in 0:18:29, average epoch loss = 0.1981
2024-07-21 04:11:42   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.76, R@5: 96.49, R@10: 97.03, R@100: 98.11
2024-07-21 04:11:42   Improved: previous best R@1 = 91.4, current R@1 = 91.8
2024-07-21 04:11:43   Start training epoch: 04
2024-07-21 04:30:22   Finished epoch 04 in 0:18:30, average epoch loss = 0.1634
2024-07-21 04:31:57   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.16, R@5: 96.76, R@10: 97.16, R@100: 98.92
2024-07-21 04:31:57   Improved: previous best R@1 = 91.8, current R@1 = 92.2
2024-07-21 04:31:58   Start training epoch: 05
2024-07-21 04:50:36   Finished epoch 05 in 0:18:29, average epoch loss = 0.1436
2024-07-21 04:52:10   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.89, R@5: 96.22, R@10: 97.03, R@100: 98.65
2024-07-21 04:52:10   Not improved: 1 / 3: best R@1 = 92.2, current R@1 = 91.9
2024-07-21 04:52:10   Start training epoch: 06
2024-07-21 05:10:49   Finished epoch 06 in 0:18:29, average epoch loss = 0.1351
2024-07-21 05:12:24   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.49, R@5: 96.62, R@10: 97.16, R@100: 98.65
2024-07-21 05:12:24   Not improved: 2 / 3: best R@1 = 92.2, current R@1 = 91.5
2024-07-21 05:12:24   Start training epoch: 07
2024-07-21 05:31:02   Finished epoch 07 in 0:18:29, average epoch loss = 0.1262
2024-07-21 05:32:36   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.76, R@5: 96.76, R@10: 97.43, R@100: 98.65
2024-07-21 05:32:36   Not improved: 3 / 3: best R@1 = 92.2, current R@1 = 91.8
2024-07-21 05:32:37   Performance did not improve for 3 epochs. Stop training.
2024-07-21 05:32:37   Best R@1: 92.2
2024-07-21 05:32:37   Trained for 08 epochs, in total in 2:41:58
2024-07-21 05:32:37   using MLP layer as FFN
2024-07-21 05:32:39   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-21 05:35:04   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.28, R@5: 96.60, R@10: 97.46, R@100: 99.21
2024-07-21 05:35:04   Finished in 2:44:26
2024-07-21 05:35:05   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-21 05:37:05   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 94.50, R@5: 97.79, R@10: 98.44, R@100: 99.57
2024-07-21 05:37:05   Finished in 2:46:27
