2024-07-06 23:21:10   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_23-21-10', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-06 23:21:10   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_23-21-10
2024-07-06 23:21:10   Using 1 GPUs
2024-07-06 23:21:10   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-06 23:21:11   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-06 23:21:11   using MLP layer as FFN
2024-07-06 23:21:13   trainable params: 28953605 || all params: 87176453 || trainable%: 33.21
2024-07-06 23:21:13   Start training epoch: 00
2024-07-06 23:25:55   Finished epoch 00 in 0:04:41, average epoch loss = 0.4343
2024-07-06 23:25:55   Extracting database features for evaluation/testing
2024-07-06 23:28:16   Extracting queries features for evaluation/testing
2024-07-06 23:28:23   Calculating recalls
2024-07-06 23:28:23   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 86.2, R@5: 94.6, R@10: 95.0, R@100: 98.8
2024-07-06 23:28:23   Improved: previous best R@1 = 0.0, current R@1 = 86.2
2024-07-06 23:28:24   Start training epoch: 01
2024-07-06 23:33:05   Finished epoch 01 in 0:04:40, average epoch loss = 0.3016
2024-07-06 23:33:05   Extracting database features for evaluation/testing
2024-07-06 23:35:26   Extracting queries features for evaluation/testing
2024-07-06 23:35:33   Calculating recalls
2024-07-06 23:35:33   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.5, R@5: 94.9, R@10: 96.4, R@100: 97.8
2024-07-06 23:35:33   Improved: previous best R@1 = 86.2, current R@1 = 88.5
2024-07-06 23:35:34   Start training epoch: 02
2024-07-06 23:40:15   Finished epoch 02 in 0:04:40, average epoch loss = 0.2416
2024-07-06 23:40:15   Extracting database features for evaluation/testing
2024-07-06 23:42:37   Extracting queries features for evaluation/testing
2024-07-06 23:42:43   Calculating recalls
2024-07-06 23:42:44   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.0, R@5: 95.4, R@10: 95.9, R@100: 98.0
2024-07-06 23:42:44   Improved: previous best R@1 = 88.5, current R@1 = 90.0
2024-07-06 23:42:45   Start training epoch: 03
2024-07-06 23:47:26   Finished epoch 03 in 0:04:40, average epoch loss = 0.2003
2024-07-06 23:47:26   Extracting database features for evaluation/testing
2024-07-06 23:49:47   Extracting queries features for evaluation/testing
2024-07-06 23:49:54   Calculating recalls
2024-07-06 23:49:54   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.0, R@5: 95.0, R@10: 96.5, R@100: 98.1
2024-07-06 23:49:54   Not improved: 1 / 10: best R@1 = 90.0, current R@1 = 90.0
2024-07-06 23:49:55   Start training epoch: 04
2024-07-06 23:54:35   Finished epoch 04 in 0:04:40, average epoch loss = 0.1704
2024-07-06 23:54:35   Extracting database features for evaluation/testing
2024-07-06 23:56:56   Extracting queries features for evaluation/testing
2024-07-06 23:57:03   Calculating recalls
2024-07-06 23:57:04   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.9, R@5: 95.8, R@10: 96.5, R@100: 98.2
2024-07-06 23:57:04   Improved: previous best R@1 = 90.0, current R@1 = 90.9
2024-07-06 23:57:04   Best R@1: 90.9
2024-07-06 23:57:04   Trained for 05 epochs, in total in 0:35:54
2024-07-06 23:57:04   using MLP layer as FFN
2024-07-06 23:57:06   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-06 23:57:06   Extracting database features for evaluation/testing
2024-07-06 23:59:15   Extracting queries features for evaluation/testing
2024-07-07 00:00:44   Calculating recalls
2024-07-07 00:00:47   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 91.9, R@5: 96.4, R@10: 97.4, R@100: 99.4
2024-07-07 00:00:47   Finished in 0:39:36
