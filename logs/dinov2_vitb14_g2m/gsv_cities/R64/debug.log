2024-07-06 19:32:16   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=64, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_19-32-16', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-06 19:32:16   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-06_19-32-16
2024-07-06 19:32:16   Using 1 GPUs
2024-07-06 19:32:16   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-06 19:32:17   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-06 19:32:17   using MLP layer as FFN
2024-07-06 19:32:19   trainable params: 29047362 || all params: 87270210 || trainable%: 33.28
2024-07-06 19:32:19   Start training epoch: 00
2024-07-06 19:37:02   Finished epoch 00 in 0:04:43, average epoch loss = 0.4338
2024-07-06 19:37:02   Extracting database features for evaluation/testing
2024-07-06 19:39:25   Extracting queries features for evaluation/testing
2024-07-06 19:39:32   Calculating recalls
2024-07-06 19:39:33   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 87.8, R@5: 94.9, R@10: 95.5, R@100: 97.8
2024-07-06 19:39:33   Improved: previous best R@1 = 0.0, current R@1 = 87.8
2024-07-06 19:39:33   Start training epoch: 01
2024-07-06 19:44:16   Finished epoch 01 in 0:04:42, average epoch loss = 0.2999
2024-07-06 19:44:16   Extracting database features for evaluation/testing
2024-07-06 19:46:39   Extracting queries features for evaluation/testing
2024-07-06 19:46:46   Calculating recalls
2024-07-06 19:46:46   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.4, R@5: 95.5, R@10: 96.4, R@100: 98.1
2024-07-06 19:46:46   Improved: previous best R@1 = 87.8, current R@1 = 88.4
2024-07-06 19:46:47   Start training epoch: 02
2024-07-06 19:51:30   Finished epoch 02 in 0:04:42, average epoch loss = 0.2417
2024-07-06 19:51:30   Extracting database features for evaluation/testing
2024-07-06 19:53:52   Extracting queries features for evaluation/testing
2024-07-06 19:53:59   Calculating recalls
2024-07-06 19:54:00   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.0, R@5: 94.9, R@10: 95.8, R@100: 98.0
2024-07-06 19:54:00   Improved: previous best R@1 = 88.4, current R@1 = 90.0
2024-07-06 19:54:01   Start training epoch: 03
2024-07-06 19:58:43   Finished epoch 03 in 0:04:42, average epoch loss = 0.1997
2024-07-06 19:58:43   Extracting database features for evaluation/testing
2024-07-06 20:01:05   Extracting queries features for evaluation/testing
2024-07-06 20:01:12   Calculating recalls
2024-07-06 20:01:13   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.1, R@5: 95.4, R@10: 96.2, R@100: 98.4
2024-07-06 20:01:13   Improved: previous best R@1 = 90.0, current R@1 = 90.1
2024-07-06 20:01:14   Start training epoch: 04
2024-07-06 20:05:56   Finished epoch 04 in 0:04:42, average epoch loss = 0.1689
2024-07-06 20:05:56   Extracting database features for evaluation/testing
2024-07-06 20:08:19   Extracting queries features for evaluation/testing
2024-07-06 20:08:26   Calculating recalls
2024-07-06 20:08:26   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.5, R@5: 95.0, R@10: 95.7, R@100: 98.5
2024-07-06 20:08:26   Not improved: 1 / 10: best R@1 = 90.1, current R@1 = 89.5
2024-07-06 20:08:27   Best R@1: 90.1
2024-07-06 20:08:27   Trained for 05 epochs, in total in 0:36:10
2024-07-06 20:08:27   using MLP layer as FFN
2024-07-06 20:08:28   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-06 20:08:28   Extracting database features for evaluation/testing
2024-07-06 20:10:38   Extracting queries features for evaluation/testing
2024-07-06 20:12:07   Calculating recalls
2024-07-06 20:12:10   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.5, R@5: 96.8, R@10: 97.5, R@100: 99.2
2024-07-06 20:12:10   Finished in 0:39:53
