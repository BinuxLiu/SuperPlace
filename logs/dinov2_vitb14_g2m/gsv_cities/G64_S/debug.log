2024-07-07 02:23:50   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=4, features_dim=768, infer_batch_size=256, linear_dim=256, lr=1e-05, num_hiddens=64, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume='logs/dinov2_vitb14_g2m/gsv_cities/G64/best_model.pth', save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-07_02-23-50', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 02:23:50   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-07_02-23-50
2024-07-07 02:23:50   Using 4 GPUs
2024-07-07 02:23:50   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-07 02:23:51   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 02:23:51   using MLP layer as FFN
2024-07-07 02:23:52   trainable params: 29047362 || all params: 87270210 || trainable%: 33.28
2024-07-07 02:23:52   Loading checkpoint: logs/dinov2_vitb14_g2m/gsv_cities/G64/best_model.pth
2024-07-07 02:23:53   Loaded checkpoint: start_epoch_num = 3, current_best_R@1 = 90.4
2024-07-07 02:23:53   Resuming from epoch 3 with best recall@1 90.4
2024-07-07 02:23:53   Start training epoch: 03
2024-07-07 02:24:41   Finished epoch 03 in 0:00:48, average epoch loss = 0.1360
2024-07-07 02:24:41   Extracting database features for evaluation/testing
2024-07-07 02:25:36   Extracting queries features for evaluation/testing
2024-07-07 02:25:41   Calculating recalls
2024-07-07 02:25:41   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 89.59, R@5: 96.08, R@10: 96.49, R@100: 98.11
2024-07-07 02:25:41   Not improved: 1 / 10: best R@1 = 90.4, current R@1 = 89.6
2024-07-07 02:25:42   Best R@1: 90.4
2024-07-07 02:25:42   Trained for 04 epochs, in total in 0:01:51
2024-07-07 02:25:42   using MLP layer as FFN
2024-07-07 02:25:44   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 02:25:44   Extracting database features for evaluation/testing
2024-07-07 02:26:26   Extracting queries features for evaluation/testing
2024-07-07 02:26:59   Calculating recalls
2024-07-07 02:27:02   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.18, R@5: 96.60, R@10: 97.40, R@100: 99.06
2024-07-07 02:27:02   Finished in 0:03:11
2024-07-07 02:27:02   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 02:27:02   Extracting database features for evaluation/testing
2024-07-07 02:27:34   Extracting queries features for evaluation/testing
2024-07-07 02:28:05   Calculating recalls
2024-07-07 02:28:07   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 92.29, R@5: 96.68, R@10: 97.70, R@100: 99.50
2024-07-07 02:28:07   Finished in 0:04:16
