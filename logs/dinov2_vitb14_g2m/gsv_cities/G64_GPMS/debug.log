2024-07-10 22:28:39   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', efficient_ram_testing=False, epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=64, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-10_22-28-39', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=True, use_cls=False, use_extra_datasets=True, use_linear=False, use_lora=False, val_positive_dist_threshold=25)
2024-07-10 22:28:39   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-10_22-28-39
2024-07-10 22:28:39   Using 3 GPUs
2024-07-10 22:28:39   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-10 22:28:39   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-10 22:28:39   using MLP layer as FFN
2024-07-10 22:28:41   trainable params: 29047362 || all params: 87270210 || trainable%: 33.28
2024-07-10 22:28:41   module.backbone.model.blocks.8.norm1.weight, module.backbone.model.blocks.8.attn.q.weight, module.backbone.model.blocks.8.attn.k.weight, module.backbone.model.blocks.8.attn.v.weight, module.backbone.model.blocks.8.attn.proj.weight, module.backbone.model.blocks.8.ls1.gamma, module.backbone.model.blocks.8.norm2.weight, module.backbone.model.blocks.8.mlp.fc1.weight, module.backbone.model.blocks.8.mlp.fc2.weight, module.backbone.model.blocks.8.ls2.gamma, module.backbone.model.blocks.9.norm1.weight, module.backbone.model.blocks.9.attn.q.weight, module.backbone.model.blocks.9.attn.k.weight, module.backbone.model.blocks.9.attn.v.weight, module.backbone.model.blocks.9.attn.proj.weight, module.backbone.model.blocks.9.ls1.gamma, module.backbone.model.blocks.9.norm2.weight, module.backbone.model.blocks.9.mlp.fc1.weight, module.backbone.model.blocks.9.mlp.fc2.weight, module.backbone.model.blocks.9.ls2.gamma, module.backbone.model.blocks.10.norm1.weight, module.backbone.model.blocks.10.attn.q.weight, module.backbone.model.blocks.10.attn.k.weight, module.backbone.model.blocks.10.attn.v.weight, module.backbone.model.blocks.10.attn.proj.weight, module.backbone.model.blocks.10.ls1.gamma, module.backbone.model.blocks.10.norm2.weight, module.backbone.model.blocks.10.mlp.fc1.weight, module.backbone.model.blocks.10.mlp.fc2.weight, module.backbone.model.blocks.10.ls2.gamma, module.backbone.model.blocks.11.norm1.weight, module.backbone.model.blocks.11.attn.q.weight, module.backbone.model.blocks.11.attn.k.weight, module.backbone.model.blocks.11.attn.v.weight, module.backbone.model.blocks.11.attn.proj.weight, module.backbone.model.blocks.11.ls1.gamma, module.backbone.model.blocks.11.norm2.weight, module.backbone.model.blocks.11.mlp.fc1.weight, module.backbone.model.blocks.11.mlp.fc2.weight, module.backbone.model.blocks.11.ls2.gamma, module.aggregation.gem.p, module.aggregation.channel_attention.channel_attention.0.p, module.aggregation.channel_attention.channel_attention.2.weight, module.aggregation.channel_attention.channel_attention.4.weight, module.aggregation.feat_proj.0.weight
2024-07-10 22:28:41   Start training epoch: 00
2024-07-10 22:37:43   Finished epoch 00 in 0:08:52, average epoch loss = 0.4451
2024-07-10 22:37:43   Extracting database features for evaluation/testing
2024-07-10 22:38:48   Extracting queries features for evaluation/testing
2024-07-10 22:38:52   Calculating recalls
2024-07-10 22:38:52   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.81, R@5: 95.27, R@10: 96.08, R@100: 98.11
2024-07-10 22:38:52   Improved: previous best R@1 = 0.0, current R@1 = 90.8
2024-07-10 22:38:53   Start training epoch: 01
2024-07-10 22:47:49   Finished epoch 01 in 0:08:47, average epoch loss = 0.3263
2024-07-10 22:47:49   Extracting database features for evaluation/testing
2024-07-10 22:48:54   Extracting queries features for evaluation/testing
2024-07-10 22:48:58   Calculating recalls
2024-07-10 22:48:58   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.54, R@5: 95.95, R@10: 96.62, R@100: 98.65
2024-07-10 22:48:58   Not improved: 1 / 10: best R@1 = 90.8, current R@1 = 90.5
2024-07-10 22:48:59   Start training epoch: 02
2024-07-10 22:57:55   Finished epoch 02 in 0:08:47, average epoch loss = 0.2720
2024-07-10 22:57:55   Extracting database features for evaluation/testing
2024-07-10 22:58:59   Extracting queries features for evaluation/testing
2024-07-10 22:59:03   Calculating recalls
2024-07-10 22:59:04   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.30, R@5: 96.89, R@10: 97.57, R@100: 98.51
2024-07-10 22:59:04   Improved: previous best R@1 = 90.8, current R@1 = 92.3
2024-07-10 22:59:05   Start training epoch: 03
2024-07-10 23:08:02   Finished epoch 03 in 0:08:48, average epoch loss = 0.2318
2024-07-10 23:08:02   Extracting database features for evaluation/testing
2024-07-10 23:09:07   Extracting queries features for evaluation/testing
2024-07-10 23:09:11   Calculating recalls
2024-07-10 23:09:11   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.89, R@5: 96.62, R@10: 97.16, R@100: 98.38
2024-07-10 23:09:11   Not improved: 1 / 10: best R@1 = 92.3, current R@1 = 91.9
2024-07-10 23:09:12   Start training epoch: 04
2024-07-10 23:18:08   Finished epoch 04 in 0:08:48, average epoch loss = 0.1976
2024-07-10 23:18:08   Extracting database features for evaluation/testing
2024-07-10 23:19:13   Extracting queries features for evaluation/testing
2024-07-10 23:19:18   Calculating recalls
2024-07-10 23:19:18   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 92.43, R@5: 96.76, R@10: 97.43, R@100: 98.65
2024-07-10 23:19:18   Improved: previous best R@1 = 92.3, current R@1 = 92.4
2024-07-10 23:19:19   Best R@1: 92.4
2024-07-10 23:19:19   Trained for 05 epochs, in total in 0:50:39
2024-07-10 23:19:19   using MLP layer as FFN
2024-07-10 23:19:21   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-10 23:19:21   Extracting database features for evaluation/testing
2024-07-10 23:20:14   Extracting queries features for evaluation/testing
2024-07-10 23:20:51   Calculating recalls
2024-07-10 23:20:54   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 91.99, R@5: 96.63, R@10: 97.43, R@100: 99.13
2024-07-10 23:20:54   Finished in 0:52:14
2024-07-10 23:20:54   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-10 23:20:54   Extracting database features for evaluation/testing
2024-07-10 23:21:30   Extracting queries features for evaluation/testing
2024-07-10 23:22:07   Calculating recalls
2024-07-10 23:22:09   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 93.22, R@5: 97.39, R@10: 98.16, R@100: 99.45
2024-07-10 23:22:09   Finished in 0:53:30
