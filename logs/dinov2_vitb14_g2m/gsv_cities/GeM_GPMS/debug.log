2024-07-07 10:18:39   Arguments: Namespace(aggregation='g2m', backbone='dinov2_vitb14', ca_method='gem', clusters=64, dataset_name='msls', datasets_folder='/root/autodl-tmp', epochs_num=5, features_dim=768, infer_batch_size=64, linear_dim=256, lr=6e-05, num_hiddens=3, num_preds_to_save=0, num_workers=16, patience=10, pca_dataset_folder=None, pca_dim=None, queries_name=None, recall_values=[1, 5, 10, 100], resize=[224, 224], resize_test_imgs=True, resume=None, save_dir='logs/dinov2_vitb14_g2m/gsv_cities/2024-07-07_10-18-39', save_only_wrong_preds=False, seed=0, train_batch_size=64, trainable_layers='8, 9, 10, 11', use_amp16=True, use_ca=False, use_cls=False, use_extra_datasets=True, use_lora=False, val_positive_dist_threshold=25)
2024-07-07 10:18:39   The outputs are being saved in logs/dinov2_vitb14_g2m/gsv_cities/2024-07-07_10-18-39
2024-07-07 10:18:39   Using 1 GPUs
2024-07-07 10:18:39   Loading gsv_cities and msls from folder /root/autodl-tmp
2024-07-07 10:18:39   Val set: < BaseDataset, msls - #database: 18871; #queries: 740 >
2024-07-07 10:18:39   using MLP layer as FFN
2024-07-07 10:18:41   trainable params: 28948225 || all params: 87171073 || trainable%: 33.21
2024-07-07 10:18:41   Start training epoch: 00
2024-07-07 10:33:12   Finished epoch 00 in 0:14:21, average epoch loss = 0.4446
2024-07-07 10:33:12   Extracting database features for evaluation/testing
2024-07-07 10:35:32   Extracting queries features for evaluation/testing
2024-07-07 10:35:39   Calculating recalls
2024-07-07 10:35:40   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 88.24, R@5: 95.54, R@10: 96.76, R@100: 98.51
2024-07-07 10:35:40   Improved: previous best R@1 = 0.0, current R@1 = 88.2
2024-07-07 10:35:40   Start training epoch: 01
2024-07-07 10:50:10   Finished epoch 01 in 0:14:20, average epoch loss = 0.3257
2024-07-07 10:50:10   Extracting database features for evaluation/testing
2024-07-07 10:52:31   Extracting queries features for evaluation/testing
2024-07-07 10:52:37   Calculating recalls
2024-07-07 10:52:38   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 90.81, R@5: 96.62, R@10: 97.03, R@100: 98.51
2024-07-07 10:52:38   Improved: previous best R@1 = 88.2, current R@1 = 90.8
2024-07-07 10:52:39   Start training epoch: 02
2024-07-07 11:07:07   Finished epoch 02 in 0:14:19, average epoch loss = 0.2721
2024-07-07 11:07:07   Extracting database features for evaluation/testing
2024-07-07 11:09:27   Extracting queries features for evaluation/testing
2024-07-07 11:09:34   Calculating recalls
2024-07-07 11:09:35   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.35, R@5: 96.49, R@10: 96.76, R@100: 98.51
2024-07-07 11:09:35   Improved: previous best R@1 = 90.8, current R@1 = 91.4
2024-07-07 11:09:35   Start training epoch: 03
2024-07-07 11:24:04   Finished epoch 03 in 0:14:20, average epoch loss = 0.2312
2024-07-07 11:24:04   Extracting database features for evaluation/testing
2024-07-07 11:26:24   Extracting queries features for evaluation/testing
2024-07-07 11:26:31   Calculating recalls
2024-07-07 11:26:32   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.49, R@5: 96.35, R@10: 96.89, R@100: 98.51
2024-07-07 11:26:32   Improved: previous best R@1 = 91.4, current R@1 = 91.5
2024-07-07 11:26:33   Start training epoch: 04
2024-07-07 11:41:00   Finished epoch 04 in 0:14:18, average epoch loss = 0.1970
2024-07-07 11:41:00   Extracting database features for evaluation/testing
2024-07-07 11:43:20   Extracting queries features for evaluation/testing
2024-07-07 11:43:28   Calculating recalls
2024-07-07 11:43:28   Recalls on val set < BaseDataset, msls - #database: 18871; #queries: 740 >: R@1: 91.35, R@5: 96.08, R@10: 97.16, R@100: 98.51
2024-07-07 11:43:28   Not improved: 1 / 10: best R@1 = 91.5, current R@1 = 91.4
2024-07-07 11:43:29   Best R@1: 91.5
2024-07-07 11:43:29   Trained for 05 epochs, in total in 1:24:50
2024-07-07 11:43:29   using MLP layer as FFN
2024-07-07 11:43:31   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2024-07-07 11:43:31   Extracting database features for evaluation/testing
2024-07-07 11:45:39   Extracting queries features for evaluation/testing
2024-07-07 11:47:07   Calculating recalls
2024-07-07 11:47:09   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 92.41, R@5: 96.83, R@10: 97.70, R@100: 99.41
2024-07-07 11:47:09   Finished in 1:28:30
2024-07-07 11:47:09   Test set: < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >
2024-07-07 11:47:09   Extracting database features for evaluation/testing
2024-07-07 11:48:35   Extracting queries features for evaluation/testing
2024-07-07 11:50:00   Calculating recalls
2024-07-07 11:50:03   Recalls on < BaseDataset, sf_xl - #database: 8015; #queries: 7993 >: R@1: 92.58, R@5: 97.00, R@10: 97.77, R@100: 99.37
2024-07-07 11:50:03   Finished in 1:31:23
